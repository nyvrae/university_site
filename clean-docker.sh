#!/bin/bash

echo "=== Очистка Docker для освобождения места ==="

# Остановка всех контейнеров
echo "Останавливаем все контейнеры..."
docker stop $(docker ps -a -q) 2>/dev/null || true

# Удаление всех остановленных контейнеров
echo "Удаляем остановленные контейнеры..."
docker rm $(docker ps -a -q) 2>/dev/null || true

# Удаление неиспользуемых образов
echo "Удаляем неиспользуемые образы..."
docker image prune -a -f

# Удаление неиспользуемых томов
echo "Удаляем неиспользуемые тома..."
docker volume prune -f

# Удаление неиспользуемых сетей
echo "Удаляем неиспользуемые сети..."
docker network prune -f

# Удаление всего неиспользуемого
echo "Удаляем все неиспользуемые ресурсы..."
docker system prune -a -f

# Проверка свободного места
echo -e "\n=== Свободное место на диске ==="
df -h /

echo -e "\n=== Очистка завершена ===" 